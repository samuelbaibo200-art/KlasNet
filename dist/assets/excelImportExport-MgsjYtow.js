const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-CY1B4Y5x.js","assets/index-D9-ZheVl.js","assets/index-DLMKmEeE.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{_ as y}from"./index-D9-ZheVl.js";async function M(l,t){return new Promise(async(a,r)=>{const o=new FileReader;o.onload=async n=>{try{const s=n.target.result,d=await y(()=>import("./xlsx-DGuHH-KN.js"),[]),f=d&&(d.default||d),v=new Uint8Array(s),x=f.read(v,{type:"array"}),A=x.SheetNames[0],P=x.Sheets[A],c=f.utils.sheet_to_json(P,{header:1});if(!c||c.length===0){r("Fichier Excel vide ou illisible");return}const i=c[0].map(e=>String(e||"").trim()),h=c.slice(1);if(!t){a({columns:i,preview:h.slice(0,5)});return}const S=t.matricule?i.findIndex(e=>e===t.matricule):-1,E=t.nom?i.findIndex(e=>e===t.nom):-1,_=t.prenoms?i.findIndex(e=>e===t.prenoms):-1,w=t.nomPrenoms?i.findIndex(e=>e===t.nomPrenoms):-1;if(S===-1){r('Colonne "Matricule" non trouvée.');return}const k=h.map(e=>{let u="",m="";if(w!==-1){const I=String(e[w]||"").trim().split(" ");u=I[0]||"",m=I.slice(1).join(" ")}else u=E!==-1?String(e[E]||"").trim():"",m=_!==-1?String(e[_]||"").trim():"";return{id:"",matricule:String(e[S]||"").trim(),nom:u,prenoms:m,sexe:"M",dateNaissance:"",lieuNaissance:"",classeId:"",anneeEntree:new Date().getFullYear().toString(),statut:"Actif",pereTuteur:"",mereTutrice:"",telephone:"",adresse:"",photo:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}});a(k)}catch(s){r(s instanceof Error?s.message:String(s))}},o.onerror=()=>r("Erreur lecture du fichier"),o.readAsArrayBuffer(l)})}async function b(l){const t=await y(()=>import("./exceljs.min-CY1B4Y5x.js").then(n=>n.e),__vite__mapDeps([0,1,2,3])),a=t&&(t.default||t),r=new a.Workbook,o=r.addWorksheet("Élèves");return o.addRow(["Matricule","Nom && Prénoms","Moyenne"]),l.forEach(n=>{o.addRow([n.matricule,`${n.nom} ${n.prenoms}`,""])}),await r.xlsx.writeBuffer()}export{b as exporterElevesEnExcel,M as importerElevesDepuisExcel};
